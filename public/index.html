<!DOCTYPE HTML>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Hades Boons</title>
  <link href="style.css" rel="stylesheet" />
  <script type="text/javascript" src="hades-boons.js"></script>
  <script type="text/javascript" src="svg-pan-zoom.min.js"></script>
</head>

<body>
  <div id="top">
    <div>
      <svg id="graph">
    </div>
  </div>
</body>

<script type="text/javascript">
  var app = Elm.HadesBoons.init()

  let canvas = document.createElement("canvas");
  let context = canvas.getContext("2d");

  // ------------------ MeasureText ------------------
  if (app.ports && app.ports.getTextWidth) {
    app.ports.getTextWidth.subscribe(function(params) {
      context.font = params.font;
      let metrics = context.measureText(params.text);
      app.ports.textSize.send({text: params.text, width: metrics.width})
    })
  }

  // ------------------ Log ------------------
  var logCommand = function(message) {
    switch(message.kind) {
      case 'debug':
        console.debug(message.note, message.value)
        break
      case 'log':
        console.log(message.note)
        break
      case 'info':
        console.info(message.note)
        break
      case 'warn':
        console.warn(message.note)
        break
      case 'error':
        console.error(message.note, message.value)
        break
      default:
        console.log('unknown message', message)
        break;
    }
  }

  if (app.ports.logCommand) {
    app.ports.logCommand.subscribe(logCommand)
  }

  var panZoom = function() {
    var element = document.querySelector('svg')
    svgPanZoom(element, {
      zoomEnabled: true,
      controlIconsEnabled: true,
      fit: true,
      center: true,
      maxZoom: 100.0,
      minZoom: 0.5
    })
  }
  panZoom()

</script>
<script defer src="svgxuse.js"></script>

</html>

